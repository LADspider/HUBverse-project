<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HUBverse - T·∫Øt l∆° ng∆° - B·∫≠t HUBverse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap&subset=vietnamese,latin-ext" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        /* General Body and Font Styles */
        body {
            font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
            background-color: #f7f9fc;
            color: #333;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
        }
        .hubverse-title, .section-title {
            font-family: 'Quicksand', 'Helvetica Neue', Arial, sans-serif;
        }

        /* Hero Section & 3D Canvas - NASA Style */
        .hero-section {
            background-color: #000;
            background-image: url('https://images.pexels.com/photos/998641/pexels-photo-998641.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2');
            background-size: cover;
            background-position: center center;
            position: relative;
            overflow: hidden;
        }
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(ellipse at center, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.8) 100%);
            z-index: 1;
        }
        #hero-3d-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2; /* Above the background overlay */
        }
        .hero-content {
            position: relative;
            z-index: 3; /* Above the canvas and overlay */
        }
        .hero-content h1, .hero-content p {
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.7);
        }

        /* Navigation */
        .nav-link {
            font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
            font-weight: 500;
            color: #4a5568;
            transition: color 0.3s ease, transform 0.2s ease, background-color 0.2s ease;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
        }
        .nav-link:hover, .nav-link.active-nav-link {
            color: #0077b6;
            background-color: #e0f7fa;
            transform: translateY(-2px);
        }

        /* Buttons */
        .btn-login {
            font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
            background-color: #00b4d8;
            color: white;
            font-weight: 600;
            padding: 0.6rem 1.2rem;
            border-radius: 0.75rem;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 180, 216, 0.3);
        }
        .btn-login:hover {
            background-color: #0096c7;
            box-shadow: 0 6px 15px rgba(0, 180, 216, 0.4);
        }
        .btn-cta {
            font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
            background-color: #fb8500;
            color: white;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border-radius: 50px;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        .btn-cta:hover {
            background-color: #e07a00;
            transform: scale(1.05);
        }
        .hero-section .btn-cta {
            background-color: #ffffff;
            color: #111827;
        }
        .hero-section .btn-cta:hover {
            background-color: #f0f0f0;
        }
        
        /* Section/Subsection Titles */
        .section-title {
            font-weight: 700;
            color: #023e8a;
            border-bottom: 3px solid #fb8500;
        }
        .subsection-title {
            font-family: 'Quicksand', 'Helvetica Neue', Arial, sans-serif;
            font-weight: 600;
            color: #0077b6;
            margin-bottom: 1.5rem;
        }

        /* Cards (Features, Products, etc.) */
        .feature-card, .product-card, .document-card, .event-card, .post-card, .team-card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #e0e0e0;
        }
        .team-card {
            cursor: pointer;
        }
        .feature-card:hover, .product-card:hover, .document-card:hover, .event-card:hover, .post-card:hover, .team-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
        }
        .feature-card .icon-bg {
            width: 4rem; height: 4rem; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 1.5rem; font-size: 1.75rem;
            transition: transform 0.3s ease;
        }
        .feature-card:hover .icon-bg {
            transform: rotate(15deg) scale(1.1);
        }
        .icon-bg-marketplace { background-color: #ffedd5; color: #f97316; }
        .icon-bg-library { background-color: #dcfce7; color: #22c55e; }
        .icon-bg-news { background-color: #fef9c3; color: #eab308; }
        .icon-bg-ai { background-color: #ede9fe; color: #8b5cf6; }
        .icon-bg-social { background-color: #ffe4e6; color: #f43f5e; }

        /* Team Section Styles */
        #team-section {
            background: #000000;
            position: relative;
            overflow: hidden;
        }
        .team-section-content {
            position: relative;
            z-index: 2;
        }
        #team-3d-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        .team-card {
            background-color: rgba(30, 41, 59, 0.8); /* Darker card background with transparency */
            border: 1px solid #334155;
            text-align: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }
        .team-card:hover .team-avatar-container::before {
             animation: spin 6s linear infinite;
        }
        .team-avatar-container {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto 1.5rem auto;
        }
        .team-avatar-container::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120%;
            height: 120%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            opacity: 0.6;
            transition: opacity 0.4s ease;
        }
        .team-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #f8fafc;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 2;
        }
        
        /* Unique planet glows */
        #team-hoai .team-avatar-container::before { background: radial-gradient(circle, #f43f5e, transparent 70%); }
        #team-duyen .team-avatar-container::before { background: radial-gradient(circle, #38bdf8, transparent 70%); }
        #team-ngan .team-avatar-container::before { background: radial-gradient(circle, #4ade80, transparent 70%); } /* Green for Web Ops */
        #team-tran .team-avatar-container::before { background: radial-gradient(circle, #facc15, transparent 70%); } /* Yellow for Design */
        #team-huong .team-avatar-container::before { background: radial-gradient(circle, #a78bfa, transparent 70%); }

        .team-name {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 0.25rem;
        }
        .team-role {
            font-size: 0.9rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        /* Role-specific colors */
        #team-hoai .team-role { color: #fb7185; } /* Rose */
        #team-duyen .team-role { color: #60a5fa; } /* Blue */
        #team-tran .team-role { color: #fde047; } /* Yellow for Design */
        #team-ngan .team-role { color: #4ade80; } /* Green for Web Ops */
        #team-huong .team-role { color: #c4b5fd; } /* Violet */

        @keyframes spin {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }


        /* Footer */
        .footer {
            background-color: #003554;
            color: #ade8f4;
        }
        .footer a {
            color: #caf0f8;
            transition: color 0.3s ease;
        }
        .footer a:hover {
            color: #ffffff;
        }
        .footer .social-icon {
            transition: transform 0.3s ease;
        }
        .footer .social-icon:hover {
            transform: scale(1.2);
        }

        /* Marketplace & Library Filtering Tabs */
        .filter-tab-container {
            display: flex; flex-wrap: wrap; gap: 0.5rem;
        }
        .filter-tab-item {
            padding: 0.5rem 1rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 500; cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        }
        .library-tab { border: 1px solid #22d3ee; color: #0891b2; background-color: #cffafe; }
        .library-tab:hover, .library-tab.active-tab { background-color: #22d3ee; color: #0e7490; border-color: #06b6d4; }
        .marketplace-tab { border: 1px solid #fbbf24; color: #b45309; background-color: #fef3c7; }
        .marketplace-tab:hover, .marketplace-tab.active-tab { background-color: #fbbf24; color: #78350f; border-color: #f59e0b; }
        
        /* News & Events Tabs */
        .news-events-tabs-menu {
            display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 2rem;
            padding-bottom: 1rem; border-bottom: 2px solid #e5e7eb;
        }
        .news-event-tab-button {
            padding: 0.625rem 1.25rem; font-weight: 500; color: #4b5563;
            background-color: #f3f4f6; border-radius: 0.5rem; cursor: pointer;
            transition: all 0.2s ease-in-out; border: 1px solid transparent;
        }
        .news-event-tab-button:hover { background-color: #e5e7eb; color: #1f2937; }
        .news-event-tab-button.active-news-tab {
            background-color: #fbbf24; color: #78350f; font-weight: 600; border-color: #f59e0b;
        }
        .news-event-content-pane { display: none; padding-top: 1rem; }
        .news-event-content-pane.active { display: block; }
        
        /* AI Chatbot */
        .gemini-chat-container { background-color: #fff; border-radius: 1rem; box-shadow: 0 0 0 1px rgba(0,0,0,.1),0 2px 3px rgba(0,0,0,.1),0 4px 12px rgba(0,0,0,.1); padding: 1.5rem; max-width: 800px; margin: auto; }
        .gemini-chat-messages { height: 450px; overflow-y: auto; padding: 1rem; margin-bottom: 1rem; display: flex; flex-direction: column; gap: 1rem; }
        .gemini-chat-bubble { display: flex; gap: 0.75rem; align-items: flex-start; max-width: 90%; }
        .gemini-chat-bubble .avatar { width: 2.25rem; height: 2.25rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 500; flex-shrink: 0; }
        .gemini-chat-bubble .avatar-user { background-color: #cce7ff; color: #00529b; }
        .gemini-chat-bubble .avatar-ai { background-color: #d1fae5; color: #065f46; }
        .gemini-chat-bubble .message-content { background-color: #f3f4f6; padding: 0.75rem 1rem; border-radius: 0.75rem; line-height: 1.6; font-size: 0.95rem; word-break: break-word; }
        .gemini-chat-bubble.user { margin-left: auto; flex-direction: row-reverse; }
        .gemini-chat-bubble.user .message-content { background-color: #e0f2fe; border-top-right-radius: 0.25rem; border-top-left-radius: 0.75rem; }
        .gemini-chat-bubble.ai .message-content { border-top-left-radius: 0.25rem; }
        .gemini-chat-input-area { display: flex; gap: 0.75rem; padding-top: 0.75rem; border-top: 1px solid #e5e7eb; }
        .gemini-chat-input { flex-grow: 1; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 1rem; }
        .gemini-chat-input:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3); }
        .gemini-send-button { background-color: #2563eb; color: white; padding: 0.75rem 1.25rem; border-radius: 0.5rem; border: none; cursor: pointer; transition: background-color 0.2s; }
        .gemini-send-button:hover { background-color: #1d4ed8; }
        #ai-question-limit { font-size: 0.8rem; text-align: center; color: #6b7280; padding-bottom: 0.75rem; }

        /* Social Networking */
        .insta-post-card { background-color: #fff; border: 1px solid #dbdbdb; border-radius: 8px; margin-bottom: 1.5rem; }
        .insta-post-header .avatar { width: 2.5rem; height: 2.5rem; border-radius: 50%; margin-right: 0.75rem; border: 2px solid transparent; background: linear-gradient(white, white) padding-box, linear-gradient(to right, #f9ce34, #ee2a7b, #6228d7) border-box; }
        .line-clamp-3 { overflow: hidden; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 3; }
        
        /* Social Sidebar & Chat */
        .sidebar-tab { width: 100%; text-align: center; padding: 0.5rem; font-weight: 500; font-size: 0.875rem; color: #4b5563; border-radius: 0.375rem; transition: all 0.2s; }
        .sidebar-tab:hover { background-color: #f3f4f6; }
        .sidebar-tab.active-sidebar-tab { background-color: #ec4899; color: white; }
        .sidebar-tab-pane { display: none; }
        .sidebar-tab-pane.active-sidebar-pane { display: block; }
        .friend-item .online-status { width: 0.6rem; height: 0.6rem; border-radius: 50%; background-color: #9ca3af; border: 2px solid white; }
        .friend-item .online-status.online { background-color: #22c55e; }

        #chat-boxes-container { pointer-events: none; }
        .chat-box { pointer-events: auto; width: 320px; background-color: white; border-radius: 0.75rem 0.75rem 0 0; box-shadow: 0 0 20px rgba(0,0,0,0.15); display: flex; flex-direction: column; height: 400px; transition: height 0.2s; }
        .chat-box.minimized { height: 48px; overflow: hidden; }
        .chat-box-header { display: flex; align-items: center; padding: 0.75rem; background-color: #ec4899; color: white; border-radius: 0.75rem 0.75rem 0 0; cursor: pointer; }
        .chat-box-body { flex-grow: 1; padding: 0.75rem; overflow-y: auto; display: flex; flex-direction: column; gap: 0.75rem; }
        .chat-box-bubble { max-width: 80%; padding: 0.5rem 0.75rem; border-radius: 1rem; }
        .chat-box-bubble.sent { background-color: #e0f2fe; align-self: flex-end; border-bottom-right-radius: 0.25rem; }
        .chat-box-bubble.received { background-color: #f3f4f6; align-self: flex-start; border-bottom-left-radius: 0.25rem; }
        .chat-box-footer { padding: 0.75rem; border-top: 1px solid #e5e7eb; display: flex; gap: 0.5rem; }
        .chat-box-footer input { flex-grow: 1; border: 1px solid #d1d5db; padding: 0.5rem; border-radius: 9999px; }


        /* Modal & Notification */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content { background-color: white; padding: 2rem; border-radius: 0.75rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 500px; position: relative; }
        .modal-close-btn { position: absolute; top: 1rem; right: 1rem; background: none; border: none; font-size: 1.5rem; color: #6b7280; cursor: pointer; }
        .form-input { width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; margin-bottom: 1rem; font-size: 0.9rem; }
        .form-button { width: 100%; padding: 0.75rem; background-color: #00b4d8; color: white; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s ease; }
        .notification-toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: #2d3748; color: white; padding: 12px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 2000; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s; }
        .notification-toast.show { opacity: 1; visibility: visible; transform: translate(-50%, -10px); }
        
        /* Team Letter Modal */
        #team-letter-modal .modal-content { max-width: 600px; background: #fffcf2; }
        #team-letter-modal .letter-header { display: flex; align-items: center; gap: 1rem; padding-bottom: 1rem; border-bottom: 1px dashed #ccc; }
        #team-letter-modal .letter-header img { width: 80px; height: 80px; }
        #team-letter-modal .letter-header h3 { font-size: 1.75rem; color: #333; }
        #team-letter-modal .letter-body { font-family: 'Quicksand', sans-serif; font-size: 1.1rem; }

        /* Page simulation */
        .page-content-section { display: none; }
        .page-content-section.active-page { display: block; }
    </style>
</head>
<body class="text-gray-700">

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="#" class="text-4xl hubverse-title page-router-link" data-target-page="home">HUBverse</a>
            <nav class="hidden md:flex space-x-1 items-center">
                <a href="#" data-target-page="home" class="nav-link page-router-link active-nav-link">T·ªïng Quan</a>
                <a href="#" data-target-page="marketplace" class="nav-link page-router-link">Pass T√†i Li·ªáu</a>
                <a href="#" data-target-page="digital-library" class="nav-link page-router-link">Th∆∞ Vi·ªán S·ªë</a>
                <a href="#" data-target-page="news-events" class="nav-link page-router-link">Tin T·ª©c</a>
                <a href="#" data-target-page="ai-chatbot" class="nav-link page-router-link">AI Chat</a>
                <a href="#" data-target-page="social-networking" class="nav-link page-router-link">K·∫øt N·ªëi</a>
            </nav>
            <div id="auth-container"><button id="open-login-modal-btn" class="btn-login">ƒêƒÉng Nh·∫≠p</button></div>
        </div>
    </header>

    <main id="main-content-area">
        <!-- HOME PAGE (HERO + FEATURES) -->
        <section id="hero-section" class="hero-section text-white py-24 md:py-40 page-content-section active-page">
            <div class="hero-content container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-6">HUBverse</h1>
                <p class="text-lg md:text-2xl mb-10 max-w-2xl mx-auto leading-relaxed">T·∫Øt l∆° ng∆°, b·∫≠t HUBverse</p>
                <a href="#features-overview" id="explore-now-btn" class="btn-cta text-lg">Kh√°m Ph√° Ngay <i class="fas fa-rocket ml-2"></i></a>
            </div>
            <canvas id="hero-3d-canvas"></canvas>
        </section>

        <section id="features-overview" class="py-16 md:py-24 page-content-section active-page">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-6 section-title">Nh·ªØng ƒêi·ªÅu Tuy·ªát V·ªùi Ch·ªù ƒê√≥n B·∫°n</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10">
                    <div class="feature-card p-8 text-center"><div class="icon-bg icon-bg-marketplace mx-auto"> <i class="fas fa-store"></i> </div><h3 class="text-2xl font-semibold mb-3">Ch·ª£ Sinh Vi√™n HUB</h3><p>Mua b√°n, trao ƒë·ªïi t√†i li·ªáu, ƒë·ªì d√πng h·ªçc t·∫≠p d·ªÖ d√†ng, ti·ªán l·ª£i.</p><a href="#" data-target-page="marketplace" class="font-semibold text-orange-500 hover:text-orange-600 page-router-link">V√†o Ch·ª£ Ngay <i class="fas fa-arrow-right ml-1"></i></a></div>
                    <div class="feature-card p-8 text-center"><div class="icon-bg icon-bg-library mx-auto"> <i class="fas fa-book-open"></i> </div><h3 class="text-2xl font-semibold mb-3">Th∆∞ Vi·ªán Tri Th·ª©c</h3><p>Kho t√†i li·ªáu s·ªë phong ph√∫, ch√≠nh th·ªëng t·ª´ nh√† tr∆∞·ªùng v√† c·ªông ƒë·ªìng.</p><a href="#" data-target-page="digital-library" class="font-semibold text-green-500 hover:text-green-600 page-router-link">Kh√°m Ph√° Th∆∞ Vi·ªán <i class="fas fa-arrow-right ml-1"></i></a></div>
                    <div class="feature-card p-8 text-center"><div class="icon-bg icon-bg-news mx-auto"> <i class="fas fa-bullhorn"></i> </div><h3 class="text-2xl font-semibold mb-3">HUB News & Events</h3><p>Kh√¥ng b·ªè l·ª° b·∫•t k·ª≥ tin t·ª©c, s·ª± ki·ªán n√≥ng h·ªïi n√†o c·ªßa tr∆∞·ªùng.</p><a href="#" data-target-page="news-events" class="font-semibold text-yellow-500 hover:text-yellow-600 page-router-link">Xem Tin M·ªõi <i class="fas fa-arrow-right ml-1"></i></a></div>
                    <div class="feature-card p-8 text-center"><div class="icon-bg icon-bg-ai mx-auto"> <i class="fas fa-robot"></i> </div><h3 class="text-2xl font-semibold mb-3">Tr·ª£ L√Ω AI 24/7</h3><p>Gi·∫£i ƒë√°p m·ªçi th·∫Øc m·∫Øc h·ªçc t·∫≠p, th·ªß t·ª•c nhanh ch√≥ng, m·ªçi l√∫c m·ªçi n∆°i.</p><a href="#" data-target-page="ai-chatbot" class="font-semibold text-purple-500 hover:text-purple-600 page-router-link">H·ªèi AI Ngay <i class="fas fa-arrow-right ml-1"></i></a></div>
                    <div class="feature-card p-8 text-center"><div class="icon-bg icon-bg-social mx-auto"> <i class="fas fa-users"></i> </div><h3 class="text-2xl font-semibold mb-3">HUB Connection</h3><p>K·∫øt n·ªëi b·∫°n b√®, chia s·∫ª kho·∫£nh kh·∫Øc, x√¢y d·ª±ng c·ªông ƒë·ªìng HUBers.</p><a href="#" data-target-page="social-networking" class="font-semibold text-rose-500 hover:text-rose-600 page-router-link">Tham Gia C·ªông ƒê·ªìng <i class="fas fa-arrow-right ml-1"></i></a></div>
                    <div class="feature-card p-8 text-center bg-gray-100 border-dashed"><div class="icon-bg bg-gray-200 text-gray-500 mx-auto"> <i class="fas fa-puzzle-piece"></i> </div><h3 class="text-2xl font-semibold mb-3 text-gray-700">T√≠nh NƒÉng S·∫Øp Ra M·∫Øt</h3><p class="text-gray-500">Nhi·ªÅu ƒëi·ªÅu th√∫ v·ªã kh√°c ƒëang ƒë∆∞·ª£c HUBverse ph√°t tri·ªÉn!</p><span class="font-semibold text-gray-400">Coming Soon...</span></div>
                </div>
            </div>
        </section>

        <!-- TEAM SECTION -->
        <section id="team-section" class="py-16 md:py-24 page-content-section active-page">
            <div class="team-section-content container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-6 section-title text-white" style="border-color: #38bdf8;">Phi H√†nh ƒêo√†n HUBverse</h2>
                <p class="text-center text-slate-300 mb-12 md:mb-20 max-w-2xl mx-auto text-lg">Ch√∫ng m√¨nh l√† nh·ªØng sinh vi√™n HUB b√¨nh th∆∞·ªùng, v·ªõi m·ªôt ∆∞·ªõc m∆° kh√¥ng-b√¨nh-th∆∞·ªùng: t·∫°o ra m·ªôt kh√¥ng gian s·ªë 'c·ªßa nh√† tr·ªìng ƒë∆∞·ª£c' d√†nh ri√™ng cho c·ªông ƒë·ªìng HUBers. M·ªói th√†nh vi√™n l√† m·ªôt m·∫£nh gh√©p, c√πng nhau ch√®o l√°i con t√†u HUBverse v·ªõi m·ªôt ch√∫t code, m·ªôt ch√∫t s√°ng t·∫°o v√† r·∫•t nhi·ªÅu ƒëam m√™. H√£y l√†m quen v·ªõi t·ª•i m√¨nh nh√©!</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-8 mt-20">
                    <div id="team-hoai" class="team-card" data-name="L√™ H·ªìng Ho√†i" data-role="COO" data-color="#fb7185" data-avatar="https://placehold.co/150x150/fecaca/991b1b?text=H" data-message="Coucou, m√¨nh l√† H·ªìng Ho√†i ‚Äì m·ªôt sinh vi√™n nƒÉm 2 ng√†nh Kinh doanh s·ªë t·∫°i Tr∆∞·ªùng ƒê·∫°i h·ªçc Ng√¢n h√†ng TP.HCM, ƒë·ªìng th·ªùi l√† COO c·ªßa ‚Äúchi·∫øc web‚Äù th√∫ v·ªã n√†y . L√† m·ªôt ng∆∞·ªùi lu√¥n khao kh√°t ph√°t tri·ªÉn b·∫£n th√¢n v√† y√™u th√≠ch vi·ªác h·ªçc h·ªèi, m√¨nh ƒë·∫∑c bi·ªát quan t√¢m ƒë·∫øn vi·ªác l√†m sao ƒë·ªÉ c√°c b·∫°n sinh vi√™n c√≥ th·ªÉ ti·∫øp c·∫≠n ki·∫øn th·ª©c m·ªôt c√°ch d·ªÖ d√†ng, hi·ªáu qu·∫£ v√† k·∫øt n·ªëi v·ªõi nhau nhi·ªÅu h∆°n trong kho·∫£ng th·ªùi gian ƒë·∫°i h·ªçc qu√Ω gi√° n√†y!<br><br>Xu·∫•t ph√°t t·ª´ ch√≠nh nhu c·∫ßu th·ª±c t·∫ø khi ƒëi h·ªçc ‚Äì khi vi·ªác t√¨m ki·∫øm t√†i li·ªáu h·ªçc t·∫≠p, chia s·∫ª kinh nghi·ªám hay k·∫øt n·ªëi v·ªõi b·∫°n b√® trong tr∆∞·ªùng c√≤n kh√° r·ªùi r·∫°c v√† thi·∫øu h·ªá th·ªëng ‚Äì m√¨nh ƒë√£ c√πng m·ªôt s·ªë b·∫°n x√¢y d·ª±ng HUBverse m·ªôt trang web h·ªó tr·ª£ sinh vi√™n Ng√¢n h√†ng d·ªÖ d√†ng ti·∫øp c·∫≠n v·ªõi t√†i li·ªáu h·ªçc t·∫≠p, chia s·∫ª th√¥ng tin v√† t·∫°o n√™n m·ªôt c·ªông ƒë·ªìng sinh vi√™n nƒÉng ƒë·ªông, g·∫Øn k·∫øt h∆°n."><div class="team-avatar-container"><img src="https://placehold.co/150x150/fecaca/991b1b?text=H" alt="L√™ H·ªìng Ho√†i" class="team-avatar"></div><h3 class="team-name">L√™ H·ªìng Ho√†i</h3><p class="team-role">COO</p></div>
                    <div id="team-duyen" class="team-card" data-name="ƒê·ªó Tr·∫ßn M·ªπ Duy√™n" data-role="Head of Marketing" data-color="#60a5fa" data-avatar="https://placehold.co/150x150/bae6fd/0c4a6e?text=D" data-message="Hii, m√¨nh l√† ƒê·ªó Tr·∫ßn M·ªπ Duy√™n ‚Äì sinh vi√™n nƒÉm 2 ng√†nh Kinh t·∫ø v√† Kinh doanh s·ªë t·∫°i ƒê·∫°i h·ªçc Ng√¢n h√†ng TP.HCM, hi·ªán gi·ªØ vai tr√≤ Head of Marketing t·∫°i HUBverse.<br><br>Marketing ch·ªçn m√¨nh v√¨ m√¨nh kh√¥ng th·ªÉ ng·ªìi y√™n khi th·∫•y m·ªôt √Ω t∆∞·ªüng hay ch∆∞a ƒë∆∞·ª£c k·ªÉ ƒë√∫ng c√°ch, v√† c√†ng kh√¥ng th·ªÉ l√†m ng∆° tr∆∞·ªõc c·ªông ƒë·ªìng sinh vi√™n c√≤n thi·∫øu s·ª± k·∫øt n·ªëi. ƒê√≥ c≈©ng l√† l√Ω do m√¨nh ƒë·ªìng h√†nh c√πng HUBverse ‚Äì m·ªôt ‚Äúv≈© tr·ª• sinh vi√™n‚Äù gi√∫p sinh vi√™n HUB d·ªÖ d√†ng t√¨m t√†i li·ªáu, k·∫øt n·ªëi b·∫°n b√® trong m·ªôt h·ªá sinh th√°i g·∫ßn g≈©i v√† chu·∫©n Gen Z.<br><br>Trong vai tr√≤ hi·ªán t·∫°i, m√¨nh kh√¥ng ch·ªâ l√†m truy·ªÅn th√¥ng hay n·ªôi dung, m√† l√† ng∆∞·ªùi k·ªÉ c√¢u chuy·ªán c·ªßa HUBverse ‚Äì ƒë∆∞a nh·ªØng ti·ªán √≠ch nh·ªè b√© ƒë·∫øn g·∫ßn h∆°n v·ªõi t·ª´ng b·∫°n sinh vi√™n, b·∫±ng s·ª± ch·ªân chu, s√°ng t·∫°o v√† ch·∫•t ri√™ng.<br><br>HUBverse l√† n∆°i m√¨nh ph√°t tri·ªÉn, tr∆∞·ªüng th√†nh v√† s·ªëng ƒë√∫ng v·ªõi ƒëam m√™. H√†nh tr√¨nh c√≤n d√†i, v√† m√¨nh mong ƒë∆∞·ª£c g·∫∑p c√°c b·∫°n ·ªü nh·ªØng chi·∫øn d·ªãch b√πng n·ªï ti·∫øp theo!"><div class="team-avatar-container"><img src="https://placehold.co/150x150/bae6fd/0c4a6e?text=D" alt="ƒê·ªó Tr·∫ßn M·ªπ Duy√™n" class="team-avatar"></div><h3 class="team-name">ƒê·ªó Tr·∫ßn M·ªπ Duy√™n</h3><p class="team-role">Head of Marketing</p></div>
                    <div id="team-ngan" class="team-card" data-name="Tr·∫ßn Thi√™n Ng√¢n" data-role="Web Operations Manager" data-color="#4ade80" data-avatar="https://placehold.co/150x150/fef08a/854d0e?text=N" data-message="üéß Ch√†o b·∫°n, m√¨nh l√† Ng√¢n ‚Äì ng∆∞·ªùi ƒë·ª©ng sau nh·ªØng d√≤ng code, t√≠nh nƒÉng v√†... v√†i l·∫ßn web ‚Äúch·∫≠p ch·ªùn‚Äù c·ªßa HUBverse.<br><br>M√¨nh kh√¥ng ph·∫£i si√™u nh√¢n c√¥ng ngh·ªá, m√¨nh l√† m·ªôt ng∆∞·ªùi sinh vi√™n nh∆∞ b·∫°n ‚Äì c≈©ng t·ª´ng loay hoay gi·ªØa vi·ªác h·ªçc, l√†m, deadline, v√† c·∫£m gi√°c l·∫°c l√µng gi·ªØa m·ªôt tr∆∞·ªùng ƒë·∫°i h·ªçc ƒë√¥ng ng∆∞·ªùi.<br><br>Th·∫ø n√™n m√¨nh (v√† c·∫£ team n·ªØa) ƒë√£ t·∫°o ra HUBverse ‚Äì kh√¥ng ph·∫£i l√† m·ªôt website cho vui, m√† l√† m·ªôt n∆°i ƒë·ªÉ b·∫°n c√≥ th·ªÉ t√¨m th·∫•y m·ªôt g√≥c nh·ªè cho ch√≠nh m√¨nh gi·ªØa kh√¥ng gian s·ªë c·ªßa ƒê·∫°i h·ªçc Ng√¢n H√†ng. M√¨nh bi·∫øt, web kh√¥ng ho√†n h·∫£o. C√≥ l√∫c n√≥ s·∫Ω ch·∫≠m, c√≥ khi n√∫t b·∫•m kh√¥ng nghe l·ªùi. Nh∆∞ng m√¨nh h·ª©a l√† t·ª´ng d√≤ng code m√¨nh vi·∫øt, t·ª´ng t√≠nh nƒÉng ƒë∆∞·ª£c th√™m v√†o ‚Äì ƒë·ªÅu l√† ƒë·ªÉ b·∫°n c√≥ m·ªôt n∆°i ph√π h·ª£p thu·ªôc v·ªÅ m√¨nh, v·ª´a gi√∫p b·∫°n s√°ng t·∫°o, ph√°t tri·ªÉn l·∫°i v·ª´a m·ªü r·ªông th√™m &quot;safe zone&quot; c·ªßa ch√≠nh m√¨nh, k·∫øt n·ªëi v·ªõi nhi·ªÅu HUBers kh√°c. <br><br>C·∫£m ∆°n v√¨ b·∫°n ƒë√£ ·ªü ƒë√¢y. B√¢y gi·ªù th√¨...<br>ƒêƒÉng nh·∫≠p ƒëi, v≈© tr·ª• ƒëang ch·ªù b·∫°n l√†m ƒëi·ªÅu g√¨ ƒë√≥ hay ho!"><div class="team-avatar-container"><img src="https://placehold.co/150x150/fef08a/854d0e?text=N" alt="Tr·∫ßn Thi√™n Ng√¢n" class="team-avatar"></div><h3 class="team-name">Tr·∫ßn Thi√™n Ng√¢n</h3><p class="team-role">Web Operations Manager</p></div>
                    <div id="team-tran" class="team-card" data-name="Nguy·ªÖn Th·ªã B·∫£o Tr√¢n" data-role="Creative Design Director" data-color="#fde047" data-avatar="https://placehold.co/150x150/bbf7d0/14532d?text=T" data-message="Dear loverss,<br>M√¨nh l√† B·∫£o Tr√¢n Nguy·ªÖn, v·ª´a l√™n ch·ª©c Creative Design Director ‚Äì ng∆∞·ªùi ƒë·ª©ng sau nh·ªØng √Ω t∆∞·ªüng th·ªã gi√°c v√† tr·∫£i nghi·ªám s√°ng t·∫°o c·ªßa trang web h·ªçc t·∫≠p d√†nh cho tr∆∞·ªùng m√¨nh.<br><br>Trang web n√†y ƒë∆∞·ª£c b·ªçn m√¨nh x√¢y d·ª±ng v·ªõi 4 tr·ª• c·ªôt ch√≠nh: T√†i li·ªáu h·ªçc t·∫≠p; AI chat box; Ho·∫°t ƒë·ªông ngo·∫°i kh√≥a v√† K·∫øt b·∫°n b·ªën ph∆∞∆°ng.<br>B·ªçn m√¨nh tin r·∫±ng: Clarity is Power ‚Äì s·ª± r√µ r√†ng l√† s·ª©c m·∫°nh, kh√¥ng lo l∆° ng∆° v√¨ ƒë√£ c√≥ Hubverse.<br><br>A little bit about me: M√™ thi√™n nhi√™n, ƒë·ªông v·∫≠t v√† nh·ªØng ƒëi·ªÅu gi·∫£n d·ªã. M√¨nh th√≠ch ch·∫°y nh·∫£y, ƒë√¥i l√∫c nƒÉng l∆∞·ª£ng h∆°i cao V√† m√¨nh th√≠ch single v√¨ ch∆∞a eo ai h·∫π h·∫π.<br><br>R·∫•t vui ƒë∆∞·ª£c ƒë·ªìng h√†nh c√πng c√°c b·∫°n tr√™n h√†nh tr√¨nh h·ªçc t·∫≠p ƒë·∫ßy c·∫£m h·ª©ng n√†y!<br>Cheers!"><div class="team-avatar-container"><img src="https://placehold.co/150x150/bbf7d0/14532d?text=T" alt="Nguy·ªÖn Th·ªã B·∫£o Tr√¢n" class="team-avatar"></div><h3 class="team-name">Nguy·ªÖn Th·ªã B·∫£o Tr√¢n</h3><p class="team-role">Creative Design Director</p></div>
                    <div id="team-huong" class="team-card" data-name="Nguy·ªÖn Th·ªã Kim H∆∞·ªùng" data-role="Content Strategist" data-color="#c4b5fd" data-avatar="https://placehold.co/150x150/ddd6fe/5b21b6?text=H" data-message="Ch√†o b·∫°n, m√¨nh l√† H∆∞·ªùng - c√¥ g√°i chuy√™n ‚Äúd·ªát m·ªông‚Äù gi·ªØa th·∫ø gi·ªõi kinh t·∫ø s·ªë!<br><br>T√™n ƒë·∫ßy ƒë·ªß l√† Nguy·ªÖn Th·ªã Kim H∆∞·ªùng, sinh vi√™n nƒÉm hai ng√†nh Kinh t·∫ø Qu·ªëc t·∫ø c·ªßa Tr∆∞·ªùng ƒê·∫°i h·ªçc Ng√¢n h√†ng TP.HCM. Nh∆∞ng n·∫øu b·∫°n h·ªèi m√¨nh l√† ai, m√¨nh s·∫Ω n√≥i: ‚ÄúM√¨nh l√† ng∆∞·ªùi ƒë√£ bi·∫øn nh·ªØng ng√†y ch·∫≠t v·∫≠t nƒÉm nh·∫•t th√†nh ƒë·ªông l·ª±c ƒë·ªÉ t·∫°o ra ƒëi·ªÅu g√¨ ƒë√≥ c√≥ √≠ch cho c·∫£ m·ªôt c·ªông ƒë·ªìng sinh vi√™n.‚Äù<br><br>Ng√†y ·∫•y, gi·ªØa h√†ng ch·ªìng slide v√† b√†i gi·∫£ng t∆∞·ªüng ch·ª´ng kh√¥ng bao gi·ªù h·∫øt, m√¨nh nh·∫≠n ra kh√¥ng ch·ªâ ri√™ng m√¨nh c·∫£m th·∫•y b·ªëi r·ªëi. Th·∫ø l√† HUBver ra ƒë·ªùi ‚Äì m·ªôt g√≥c nh·ªè tr√™n m·∫°ng, n∆°i m√¨nh ƒë√≥ng vai content strategist, v·ª´a chia s·∫ª kinh nghi·ªám h·ªçc t·∫≠p, v·ª´a truy·ªÅn c·∫£m h·ª©ng cho nh·ªØng ai ƒëang loay hoay v·ªõi h√†nh tr√¨nh ƒë·∫°i h·ªçc.<br><br>M√¨nh tin r·∫±ng h·ªçc t·∫≠p kh√¥ng ch·ªâ l√† chinh ph·ª•c ki·∫øn th·ª©c, m√† c√≤n l√† h√†nh tr√¨nh t√¨m th·∫•y ch√≠nh m√¨nh, theo c√°ch th·∫≠t ri√™ng v√† ƒë·∫ßy c·∫£m h·ª©ng."><div class="team-avatar-container"><img src="https://placehold.co/150x150/ddd6fe/5b21b6?text=H" alt="Nguy·ªÖn Th·ªã Kim H∆∞·ªùng" class="team-avatar"></div><h3 class="team-name">Nguy·ªÖn Th·ªã Kim H∆∞·ªùng</h3><p class="team-role">Content Strategist</p></div>
                </div>
            </div>
            <canvas id="team-3d-canvas"></canvas>
        </section>

        <!-- OTHER PAGES (MARKETPLACE, LIBRARY, ETC.) -->
        <section id="marketplace" class="py-16 md:py-24 bg-orange-50 page-content-section">
            <div class="container mx-auto px-6">
                 <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title" style="border-color: #f97316;">Ch·ª£ Sinh Vi√™n HUBverse</h2>
                 <div id="marketplace-filter-tabs" class="filter-tab-container justify-center mb-8">
                    <button class="filter-tab-item marketplace-tab active-tab" data-filter="all">T·∫•t C·∫£</button>
                    <button class="filter-tab-item marketplace-tab" data-filter="sach">S√°ch & Gi√°o Tr√¨nh</button>
                    <button class="filter-tab-item marketplace-tab" data-filter="dungcu">D·ª•ng C·ª• H·ªçc T·∫≠p</button>
                    <button class="filter-tab-item marketplace-tab" data-filter="khac">Kh√°c</button>
                </div>
                <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></div>
            </div>
        </section>
        <section id="digital-library" class="py-16 md:py-24 bg-sky-50 page-content-section">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title" style="border-color: #0ea5e9;">Th∆∞ Vi·ªán Tri Th·ª©c HUB</h2>
                <div id="library-filter-tabs" class="filter-tab-container justify-center mb-8">
                     <button class="filter-tab-item library-tab active-tab" data-filter="all">T·∫•t C·∫£</button>
                     <button class="filter-tab-item library-tab" data-filter="tcnh">T√†i ch√≠nh - Ng√¢n h√†ng</button>
                     <button class="filter-tab-item library-tab" data-filter="ktkt">K·∫ø to√°n - Ki·ªÉm to√°n</button>
                     <button class="filter-tab-item library-tab" data-filter="qtkd">Qu·∫£n tr·ªã Kinh doanh</button>
                     <button class="filter-tab-item library-tab" data-filter="ktqt">Kinh t·∫ø Qu·ªëc t·∫ø</button>
                     <button class="filter-tab-item library-tab" data-filter="nnanh">Ng√¥n ng·ªØ Anh</button>
                     <button class="filter-tab-item library-tab" data-filter="htttql">HTTT Qu·∫£n l√≠</button>
                     <button class="filter-tab-item library-tab" data-filter="luatkt">Lu·∫≠t Kinh t·∫ø</button>
                </div>
                <div id="document-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></div>
            </div>
        </section>
        <section id="news-events" class="py-16 md:py-24 bg-yellow-50 page-content-section">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title" style="border-color: #f59e0b;">HUB News & Events Feed</h2>
                <div class="news-events-tabs-menu">
                    <button class="news-event-tab-button active-news-tab" data-target="su-kien"><i class="fas fa-calendar-check mr-2"></i>S·ª± Ki·ªán</button>
                    <button class="news-event-tab-button" data-target="minigames"><i class="fas fa-gamepad mr-2"></i>Minigames</button>
                    <button class="news-event-tab-button" data-target="tinh-nguyen"><i class="fas fa-hands-helping mr-2"></i>T√¨nh Nguy·ªán</button>
                    <button class="news-event-tab-button" data-target="hoc-thuat"><i class="fas fa-trophy mr-2"></i>H·ªçc Thu·∫≠t</button>
                </div>
                <div id="su-kien" class="news-event-content-pane active">
                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"><div class="event-card"><img src="https://placehold.co/400x220/FEF3C7/D97706?text=Gala" alt="Gala" class="w-full h-48 object-cover rounded-t-xl"><div class="p-6"><h4 class="text-xl font-semibold mb-2">Gala Ch√†o T√¢n Sinh Vi√™n</h4><p class="text-gray-600 text-sm mb-3"><i class="fas fa-clock mr-1"></i> 18:00, 28/08</p><p class="text-gray-700 text-sm mb-4 line-clamp-3">Qu·∫©y tung n√≥c v·ªõi d√†n line-up "c√¢y nh√† l√° v∆∞·ªùn". V√© v√†o c·ªïng mi·ªÖn ph√≠ nh∆∞ng v√© g·ª≠i xe th√¨ kh√¥ng!</p><a href="#" class="font-semibold text-amber-600">Xem chi ti·∫øt <i class="fas fa-arrow-right ml-1"></i></a></div></div><div class="event-card"><img src="https://placehold.co/400x220/FEF3C7/D97706?text=Job+Fair" alt="Job Fair" class="w-full h-48 object-cover rounded-t-xl"><div class="p-6"><h4 class="text-xl font-semibold mb-2">Ng√†y H·ªôi Vi·ªác L√†m HUB 2025</h4><p class="text-gray-600 text-sm mb-3"><i class="fas fa-calendar-day mr-1"></i> C·∫£ ng√†y, 20/07</p><p class="text-gray-700 text-sm mb-4 line-clamp-3">C∆° h·ªôi "b√°n th√¢n" cho c√°c t∆∞ b·∫£n l·ªõn. Nh·ªõ mang theo nhi·ªÅu CV v√† n·ª• c∆∞·ªùi th·∫≠t t∆∞∆°i.</p><a href="#" class="font-semibold text-amber-600">Xem gian h√†ng <i class="fas fa-arrow-right ml-1"></i></a></div></div></div>
                </div>
                <div id="minigames" class="news-event-content-pane"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"><div class="event-card"><img src="https://placehold.co/400x220/FEF3C7/D97706?text=Game" alt="Game" class="w-full h-48 object-cover rounded-t-xl"><div class="p-6"><h4 class="text-xl font-semibold mb-2">Truy T√¨m Admin ·∫®n Danh</h4><p class="text-gray-600 text-sm mb-3"><i class="fas fa-clock mr-1"></i> B·∫•t c·ª© khi n√†o</p><p class="text-gray-700 text-sm mb-4 line-clamp-3">Admin ƒëang ·∫©n m√¨nh trong c√°c b√†i post. Gi·∫£i ƒë∆∞·ª£c m·∫≠t m√£, nh·∫≠n ngay ly tr√† s·ªØa full topping.</p><a href="#" class="font-semibold text-amber-600">Tham gia ngay <i class="fas fa-arrow-right ml-1"></i></a></div></div></div></div>
                <div id="tinh-nguyen" class="news-event-content-pane"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"><div class="event-card"><img src="https://placehold.co/400x220/FEF3C7/D97706?text=Volunteer" alt="Volunteer" class="w-full h-48 object-cover rounded-t-xl"><div class="p-6"><h4 class="text-xl font-semibold mb-2">Ch·ªß Nh·∫≠t Xanh - D·ªçn R√°c</h4><p class="text-gray-600 text-sm mb-3"><i class="fas fa-calendar-alt mr-1"></i> 07:00, Ch·ªß nh·∫≠t</p><p class="text-gray-700 text-sm mb-4 line-clamp-3">D·ªçn s·∫°ch b·ªù k√™nh, nh·∫≠n ƒëi·ªÉm r√®n luy·ªán v√† m·ªôt tr√°i tim trong s·∫°ch. Bonus: c√≥ th·ªÉ b·∫°n s·∫Ω t√¨m th·∫•y "crush".</p><a href="#" class="font-semibold text-amber-600">ƒêƒÉng k√Ω CTV <i class="fas fa-arrow-right ml-1"></i></a></div></div></div></div>
                <div id="hoc-thuat" class="news-event-content-pane"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"><div class="event-card"><img src="https://placehold.co/400x220/FEF3C7/D97706?text=Shark+Tank" alt="Shark Tank" class="w-full h-48 object-cover rounded-t-xl"><div class="p-6"><h4 class="text-xl font-semibold mb-2">"Shark Tank" Phi√™n B·∫£n HUB</h4><p class="text-gray-600 text-sm mb-3"><i class="fas fa-gavel mr-1"></i> V√≤ng s∆° lo·∫°i: 15/09</p><p class="text-gray-700 text-sm mb-4 line-clamp-3">√ù t∆∞·ªüng c·ªßa b·∫°n c√≥ th·ªÉ nh·∫≠n ƒë∆∞·ª£c "deal" t·ª´... qu·ªπ khuy·∫øn h·ªçc c·ªßa khoa.</p><a href="#" class="font-semibold text-amber-600">N·ªôp ƒë·ªÅ √°n <i class="fas fa-arrow-right ml-1"></i></a></div></div></div></div>
            </div>
        </section>
        <section id="ai-chatbot" class="py-16 md:py-24 bg-gray-100 page-content-section">
            <div class="container mx-auto px-6">
                 <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title" style="border-color: #4f46e5;">Tr√≤ Chuy·ªán C√πng HUB AI</h2>
                 <div class="gemini-chat-container">
                     <div id="gemini-chat-messages" class="gemini-chat-messages"></div>
                     <div class="mt-4">
                        <div id="ai-question-limit" class="hidden"><p>B·∫°n c√≥ <strong><span id="question-limit-count">3</span></strong> l∆∞·ª£t h·ªèi th·ª≠. <a href="#" id="login-for-more" class="text-indigo-600 font-semibold hover:underline">ƒêƒÉng nh·∫≠p</a> ƒë·ªÉ h·ªèi kh√¥ng gi·ªõi h·∫°n.</p></div>
                        <div class="gemini-chat-input-area"><input type="text" id="gemini-chat-input" placeholder="Nh·∫Øn tin cho HUB AI..." class="gemini-chat-input"><button id="gemini-send-button" class="gemini-send-button"><i class="fas fa-paper-plane"></i></button></div>
                     </div>
                 </div>
            </div>
        </section>
        <section id="social-networking" class="py-16 md:py-24 bg-pink-50 page-content-section">
            <div class="container mx-auto px-6">
                <div id="social-guest-view" class="hidden">
                    <div class="text-center bg-white p-12 rounded-xl shadow-lg">
                        <i class="fas fa-users-slash text-6xl text-pink-300 mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">K·∫øt N·ªëi C√πng C·ªông ƒê·ªìng HUBverse</h3>
                        <p class="text-gray-600 mb-6">ƒêƒÉng nh·∫≠p ƒë·ªÉ xem b√†i vi·∫øt t·ª´ b·∫°n b√®, chia s·∫ª kho·∫£nh kh·∫Øc v√† nh·∫Øn tin nh√©!</p>
                        <button id="login-from-social-prompt" class="btn-login bg-pink-500 hover:bg-pink-600">ƒêƒÉng Nh·∫≠p / ƒêƒÉng K√Ω</button>
                    </div>
                </div>
                <div id="social-user-view" class="hidden">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title" style="border-color: #ec4899;">HUB Connection</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                        <aside class="lg:col-span-3 lg:order-1 order-2 space-y-6" id="social-friends-sidebar"></aside>
                        <div class="lg:col-span-6 lg:order-2 order-1 space-y-6">
                            <div id="new-post-box" class="bg-white p-4 rounded-lg shadow hidden"></div>
                            <div id="social-feed-container"></div>
                        </div>
                        <aside class="lg:col-span-3 lg:order-3 order-3 space-y-6" id="social-profile-sidebar"></aside>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- CTA & FOOTER -->
    <section id="cta-section" class="py-20 md:py-32 bg-gradient-to-r from-cyan-500 to-blue-500 text-white">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-3xl md:text-4xl font-bold mb-6">S·∫µn S√†ng Gia Nh·∫≠p C·ªông ƒê·ªìng HUBverse?</h2>
            <button id="open-register-modal-cta" class="btn-cta bg-white text-blue-600 hover:bg-gray-100 text-lg">ƒêƒÉng K√Ω Ngay <i class="fas fa-user-plus ml-2"></i></button>
        </div>
    </section>
    <footer id="contact" class="footer py-16">
        <div class="container mx-auto px-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-10 mb-8"><div><h3 class="text-3xl font-bold mb-4 hubverse-title text-white">HUBverse</h3><p>N·ªÅn t·∫£ng sinh vi√™n v√¨ sinh vi√™n, b·ªüi sinh vi√™n HUB.</p></div><div><h4 class="text-xl font-semibold mb-4 text-cyan-300">Kh√°m Ph√°</h4><ul class="space-y-2"><li><a href="#" data-target-page="home" class="page-router-link">T·ªïng Quan</a></li><li><a href="#" data-target-page="marketplace" class="page-router-link">Ch·ª£ Sinh Vi√™n</a></li><li><a href="#" data-target-page="digital-library" class="page-router-link">Th∆∞ Vi·ªán</a></li></ul></div><div><h4 class="text-xl font-semibold mb-4 text-cyan-300">K·∫øt N·ªëi</h4><div class="flex space-x-5 mb-4"><a href="#" class="text-2xl social-icon"><i class="fab fa-facebook-square"></i></a><a href="#" class="text-2xl social-icon"><i class="fab fa-instagram-square"></i></a></div><p class="text-sm">Email: support@hubverse.edu.vn</p></div></div><div class="mt-10 pt-8 border-t border-gray-700 text-center text-gray-400 text-sm"><p>&copy; <span id="currentYear"></span> HUBverse Team. All rights reserved.</p></div></div>
    </footer>

    <!-- MODALS & Popups -->
    <div id="login-modal" class="modal-overlay">
        <div class="modal-content"><button id="close-login-modal" class="modal-close-btn">&times;</button><h3 class="text-2xl font-semibold mb-6 text-center hubverse-title">ƒêƒÉng Nh·∫≠p</h3><form id="login-form"><div><label for="login-email" class="form-label">Email</label><input type="email" id="login-email" class="form-input" required></div><div><label for="login-password" class="form-label">M·∫≠t kh·∫©u</label><input type="password" id="login-password" class="form-input" required></div><p id="login-error" class="text-red-600 text-sm hidden"></p><button type="submit" class="form-button mt-4">ƒêƒÉng Nh·∫≠p</button><p class="text-xs text-center mt-4">Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" id="show-register-from-login" class="text-orange-500">ƒêƒÉng k√Ω</a></p></form></div>
    </div>
    <div id="register-modal" class="modal-overlay">
        <div class="modal-content"><button id="close-register-modal" class="modal-close-btn">&times;</button><h3 class="text-2xl font-semibold mb-6 text-center hubverse-title">ƒêƒÉng K√Ω</h3><form id="register-form"><div><label for="register-name" class="form-label">H·ªç v√† T√™n</label><input type="text" id="register-name" class="form-input" required></div><div><label for="register-email" class="form-label">Email</label><input type="email" id="register-email" class="form-input" required></div><div><label for="register-password" class="form-label">M·∫≠t kh·∫©u</label><input type="password" id="register-password" class="form-input" required></div><p id="register-error" class="text-red-600 text-sm hidden"></p><button type="submit" class="form-button mt-4">ƒêƒÉng K√Ω</button><p class="text-xs text-center mt-4">ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" id="show-login-from-register" class="text-orange-500">ƒêƒÉng nh·∫≠p</a></p></form></div>
    </div>
    <div id="notification-toast" class="notification-toast"></div>
    <div id="chat-boxes-container" class="fixed bottom-0 right-4 space-x-4 z-[1001] flex items-end"></div>
    <div id="team-letter-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 600px; background: #fffcf2;">
            <button id="close-letter-modal" class="modal-close-btn">&times;</button>
            <div class="letter-header flex items-center gap-4 pb-4 border-b border-dashed border-gray-300">
                <img id="letter-avatar" src="" alt="Avatar" class="w-20 h-20 rounded-full object-cover border-4 border-white shadow-md">
                <div>
                    <h3 id="letter-name" class="text-2xl font-bold text-gray-800" style="font-family: 'Quicksand', sans-serif;"></h3>
                    <p id="letter-role" class="font-semibold" style="font-family: 'Poppins', sans-serif;"></p>
                </div>
            </div>
            <div id="letter-body" class="mt-6 text-gray-700 leading-relaxed" style="font-family: 'Quicksand', sans-serif; font-size: 1.1rem;">
                <!-- Dynamic content goes here -->
            </div>
        </div>
    </div>

    <script type="module">
        // Firebase Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, setDoc, doc, getDoc, collection, updateDoc, arrayUnion, arrayRemove, serverTimestamp, addDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";

        document.addEventListener('DOMContentLoaded', async function() {
            // --- GLOBAL VARIABLES & CONFIG ---
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : { apiKey: "YOUR_API_KEY", authDomain: "YOUR_AUTH_DOMAIN", projectId: "YOUR_PROJECT_ID" };
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-hubverse';
            
            setLogLevel('debug');

            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            const db = getFirestore(app);

            let currentUser = null;
            let currentUserData = null; 
            let guestQuestionCount = 3;
            let isAppInitialized = false;

            // --- MOCK DATA FOR DEMO ---
            const mockProducts = [
                { id: 'prod1', name: 'Gi√°o tr√¨nh Kinh t·∫ø h·ªçc qu·ªëc t·∫ø (b·∫£n m·ªõi)', price: 45000, seller: 'minh.an_k19', category: 'sach', tags: ['kinh t·∫ø qu·ªëc t·∫ø', 'gi√°o tr√¨nh'], description: 'S√°ch c√≤n m·ªõi 99%, m√¨nh h·ªçc xong pass l·∫°i gi√° r·∫ª cho c√°c em.', imageUrl: 'https://placehold.co/400x300/FFEBD9/9A3412?text=KTQT' },
                { id: 'prod2', name: 'M√°y t√≠nh Casio FX-580VNX', price: 500000, seller: 'bao.tran_k20', category: 'dungcu', tags: ['m√°y t√≠nh', 'casio'], description: 'D√πng ƒë∆∞·ª£c 1 h·ªçc k·ª≥, c√≤n full box, full ch·ª©c nƒÉng, anti-fake. Thi xong kh√¥ng d√πng n·ªØa.', imageUrl: 'https://placehold.co/400x300/DDECFE/1E40AF?text=Casio' },
                { id: 'prod3', name: 'Gi√°o tr√¨nh Tri·∫øt h·ªçc M√°c-L√™nin (b·∫£n c≈©)', price: 25000, seller: 'sv.namcuoi', category: 'sach', tags: ['tri·∫øt h·ªçc', 'ƒë·∫°i c∆∞∆°ng'], description: 'Pass g·∫•p l·∫•y ti·ªÅn u·ªëng tr√† ƒë√°. S√°ch c√≥ highlight v√†i ch·ªó quan tr·ªçng, mua v·ªÅ kh·ªèi highlight l·∫°i.', imageUrl: 'https://placehold.co/400x300/FEF9C3/854D0E?text=Tri·∫øt' },
                { id: 'prod4', name: 'Apple Watch SE 40mm', price: 2500000, seller: 'rich.kid_hub', category: 'dungcu', tags: ['ƒë·ªìng h·ªì', 'apple watch'], description: 'L√™n ƒë·ªùi Ultra n√™n pass l·∫°i. C√≤n b·∫£o h√†nh, pin 95%, t·∫∑ng k√®m 3 d√¢y ƒëeo.', imageUrl: 'https://placehold.co/400x300/F3E8FF/5B21B6?text=Watch' },
                { id: 'prod5', name: 'Balo laptop ch·ªëng n∆∞·ªõc', price: 150000, seller: 'thien.ngan_art', category: 'khac', tags: ['balo', 'laptop'], description: 'Balo nhi·ªÅu ngƒÉn, ƒë·ª±ng v·ª´a laptop 15.6 inch. Mua v·ªÅ nh∆∞ng √≠t d√πng.', imageUrl: 'https://placehold.co/400x300/E0E7FF/312E81?text=Balo' },
                { id: 'prod6', name: '[Pass v√©] Concert BlackPink', price: 1200000, seller: 'blink.hub', category: 'khac', tags: ['v√©', 'concert'], description: 'B·∫≠n √¥n thi cu·ªëi k·ª≥ n√™n ƒë√†nh pass l·∫°i v√©. V·ªã tr√≠ ƒë·∫πp, gi√° g·ªëc kh√¥ng ph·ª• thu.', imageUrl: 'https://placehold.co/400x300/FCE7F3/831843?text=V√©' },
            ];
            const mockDocuments = [
                { id: 'doc1', title: 'Slide Ph√¢n t√≠ch B√°o c√°o T√†i ch√≠nh', author: 'TS. ƒêo√†n Anh Tu·∫•n', category: 'tcnh', type: 'B√†i gi·∫£ng', url: '#' },
                { id: 'doc2', title: 'T·ªïng h·ª£p 50 c√¢u h·ªèi ph·ªèng v·∫•n Big4', author: 'S∆∞u t·∫ßm', category: 'ktkt', type: 'T√†i li·ªáu', url: '#' },
                { id: 'doc3', title: 'Case Study Marketing cho Biti\'s Hunter', author: 'Nh√≥m 5 - L·ªõp QT Mar', category: 'qtkd', type: 'B√†i t·∫≠p nh√≥m', url: '#' },
                { id: 'doc4', title: 'ƒê·ªÅ c∆∞∆°ng √¥n t·∫≠p Kinh t·∫ø L∆∞·ª£ng', author: 'Khoa KTQT', category: 'ktqt', type: 'ƒê·ªÅ c∆∞∆°ng', url: '#' },
                { id: 'doc5', title: '1200 T·ª´ v·ª±ng IELTS band 8.0', author: 'IELTS Official', category: 'nnanh', type: 'T·ª´ v·ª±ng', url: '#' },
                { id: 'doc6', title: 'Gi√°o tr√¨nh SQL cho ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu', author: 'Khoa HTTTQL', category: 'htttql', type: 'Gi√°o tr√¨nh', url: '#' },
                { id: 'doc7', title: 'Lu·∫≠t Doanh nghi·ªáp 2020 (t√≥m t·∫Øt)', author: 'S∆∞u t·∫ßm', category: 'luatkt', type: 'Lu·∫≠t', url: '#' },
                { id: 'doc8', title: 'B√†i gi·∫£ng Th·ªã tr∆∞·ªùng Ch·ª©ng kho√°n', author: 'PGS. TS. Tr·∫ßn Th·ªã Kim', category: 'tcnh', type: 'B√†i gi·∫£ng', url: '#' },
            ];
            const mockPosts = [
                { id: 'post5', authorName: 'Boss Ho√†i', authorUsername: 'le.hong.hoai', authorAvatar: 'https://placehold.co/40x40/fecaca/991b1b?text=H', caption: 'Th√¥ng b√°o: Ai l√† ch·ªß nh√¢n c·ªßa con m√®o tam th·ªÉ ƒëang ng·ªß trong ph√≤ng h·ªçp ban ƒëi·ªÅu h√†nh? Deadline ƒëang d√≠ m√† n√≥ n·∫±m ƒë√≥ sao t√¥i l√†m vi·ªác?', imageUrl: 'https://placehold.co/600x400/fecaca/991b1b?text=M√®o+T√¨m+Ch·ªß', location: 'VƒÉn ph√≤ng HUBverse', likes: 555 },
                { id: 'post6', authorName: 'Kim H∆∞·ªùng', authorUsername: 'kim.huong.content', authorAvatar: 'https://placehold.co/40x40/ddd6fe/5b21b6?text=H', caption: 'Sau 7749 l·∫ßn nghƒ© caption, m√¨nh quy·∫øt ƒë·ªãnh... kh√¥ng nghƒ© n·ªØa. M·ªçi ng∆∞·ªùi t·ª± xem ·∫£nh v√† c·∫£m nh·∫≠n nh√©. #c·∫°n_√Ω_t∆∞·ªüng', imageUrl: 'https://placehold.co/600x400/ddd6fe/5b21b6?text=H·∫øt+ch·∫•t+x√°m', location: 'Qu√°n c√† ph√™ quen', likes: 123 },
                { id: 'post7', authorName: 'Duy√™n d√°ng', authorUsername: 'my.duyen.mkt', authorAvatar: 'https://placehold.co/40x40/bae6fd/0c4a6e?text=D', caption: 'Ch·∫°y qu·∫£ng c√°o cho HUBverse t·ªën bao nhi√™u kh√¥ng bi·∫øt, ch·ª© m·ªôt ly tr√† s·ªØa cho team m·ªói ng√†y l√† c√≥ th·∫≠t. #worklifebalance', imageUrl: 'https://placehold.co/600x400/bae6fd/0c4a6e?text=Tr√†+S·ªØa+Marketing', location: 'Tr√† s·ªØa √îng Th·ªç', likes: 456 },
                { id: 'post9', authorName: 'B√°o Tr√¢n', authorUsername: 'bao.tran.web', authorAvatar: 'https://placehold.co/40x40/bbf7d0/14532d?text=T', caption: 'Ch·ª•p ·∫£nh "s·ªëng ·∫£o" t·∫°i th∆∞ vi·ªán. Xin th·ªÅ l√† m√¨nh c√≥ ƒë·ªçc s√°ch, kh√¥ng ph·∫£i ch·ªâ v√†o ƒë·ªÉ ch·ª•p ·∫£nh ƒë√¢u nha. #studygram', imageUrl: 'https://placehold.co/600x400/fef08a/854d0e?text=S·ªëng+·∫£o+tri+th·ª©c', location: 'Th∆∞ vi·ªán HUB', likes: 1024 },
                { id: 'post8', authorName: 'Thi√™n Ng√¢n', authorUsername: 'nganana23', authorAvatar: 'https://placehold.co/40x40/fef08a/854d0e?text=N', caption: 'Fix xong c√°i bug th·ª© 100 trong ng√†y. T√≥c r·ª•ng h·∫øt r·ªìi, ai c√≥ ƒë·ªãa ch·ªâ b√°n t√≥c gi·∫£ uy t√≠n kh√¥ng?', imageUrl: 'https://placehold.co/600x400/bbf7d0/14532d?text=Code+Bay+M√†u', location: 'M·ªôt n∆°i tƒÉm t·ªëi', likes: 789 },
                { id: 'post1', authorName: 'Ph∆∞·ªõc Nguy·ªÖn', authorUsername: 'phuoc.nguyen', authorAvatar: 'https://placehold.co/40x40/dbeafe/1e40af?text=P', caption: 'Tr√† ƒë√° c·ªïng sau c∆° s·ªü Ho√†ng Di·ªáu 2 v·∫´n l√† ch√¢n √°i m·ªçi ng∆∞·ªùi ·∫°. 3k m·ªôt ly, ch·ªó ng·ªìi "view" tri·ªáu ƒë√¥ nh√¨n d√≤ng ng∆∞·ªùi h·ªëi h·∫£.', location: 'Th·ªß ƒê·ª©c, TP.HCM', likes: 102 },
                { id: 'post2', authorName: 'Minh Anh', authorUsername: 'minhanh.hub', authorAvatar: 'https://placehold.co/40x40/fce7f3/9d174d?text=M', caption: 'ƒêi·ªÉm danh team K20 chu·∫©n b·ªã ch·∫°y deadline ng·∫≠p m·∫∑t n√†o :)) Ai c√≥ b√≠ k√≠p qua m√¥n T∆∞ t∆∞·ªüng kh√¥ng chia s·∫ª v·ªõi...', imageUrl: 'https://placehold.co/600x400/FFF7ED/C2410C?text=Deadline', location: 'Th∆∞ vi·ªán HUB', likes: 256 },
                { id: 'post3', authorName: 'B·∫£o Tr√¢n Foodie', authorUsername: 'baotran.foodie', authorAvatar: 'https://placehold.co/40x40/ecfdf5/047857?text=B', caption: 'M·ªõi ph√°t hi·ªán qu√°n b√∫n ƒë·∫≠u m·∫Øm t√¥m g·∫ßn c∆° s·ªü H√†m Nghi si√™u ƒë·ªânh, ƒë·∫ßy ƒë·∫∑n m√† c√≥ 45 c√†nh. Ai c·∫ßn review chi ti·∫øt kh√¥ng?', location: 'Qu·∫≠n 1, TP.HCM', likes: 312 },
                { id: 'post4', authorName: 'Sinh Vi√™n NƒÉm Cu·ªëi', authorUsername: 'sv.namcuoi', authorAvatar: 'https://placehold.co/40x40/f3f4f6/4b5563?text=S', caption: 'C√≥ ai pass l·∫°i m√¥n X√°c su·∫•t th·ªëng k√™ kh√¥ng ·∫°, em c·∫£m ∆°n v√† h·∫≠u t·∫° b·∫±ng 1 ly tr√† s·ªØa full topping ·∫° :((', location: 'T√¨m ƒë·ªìng ƒë·ªôi', likes: 55 },
            ];
            const demoUserFriends = [
                { id: 'friend1', name: 'B·∫£o Tr√¢n Foodie', avatar: 'https://placehold.co/40x40/ecfdf5/047857?text=B', online: true },
                { id: 'friend2', name: 'Ph∆∞·ªõc Nguy·ªÖn', avatar: 'https://placehold.co/40x40/dbeafe/1e40af?text=P', online: false },
                { id: 'friend3', name: 'Minh Anh', avatar: 'https://placehold.co/40x40/fce7f3/9d174d?text=M', online: true },
                { id: 'friend4', name: 'Boss Ho√†i', avatar: 'https://placehold.co/40x40/fecaca/991b1b?text=H', online: true },
                { id: 'friend5', name: 'Duy√™n d√°ng', avatar: 'https://placehold.co/40x40/bae6fd/0c4a6e?text=D', online: false },
            ];
            const demoUserConversations = [
                { friendId: 'friend4', name: 'Boss Ho√†i', lastMessage: 'Em t√¨m ch·ªß cho con m√®o ch∆∞a?', unread: 1, avatar: 'https://placehold.co/40x40/fecaca/991b1b?text=H' },
                { friendId: 'friend5', name: 'Duy√™n d√°ng', lastMessage: 'Mai c√≥ ƒëi u·ªëng tr√† s·ªØa kh√¥ng em?', unread: 0, avatar: 'https://placehold.co/40x40/bae6fd/0c4a6e?text=D' },
            ];

            // --- NOTIFICATION FUNCTION ---
            function showToast(message) {
                const toast = document.getElementById('notification-toast');
                if (!toast) return;
                toast.textContent = message;
                toast.classList.add('show');
                setTimeout(() => { toast.classList.remove('show'); }, 3000);
            }

            // --- AUTHENTICATION & USER MANAGEMENT ---
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) { await signInWithCustomToken(auth, __initial_auth_token); } 
                else { await signInAnonymously(auth); }
            } catch (error) {
                console.error("Auth initialization failed:", error);
                await signInAnonymously(auth);
            }
            
            onAuthStateChanged(auth, async (user) => {
                if (user && !user.isAnonymous) {
                    currentUser = user;
                    // Prevent demo user from being overwritten by auth state
                    if (currentUserData && currentUserData.id === 'demo-user-ngan' && currentUser.email !== 'nganana23@gmail.com') {
                        currentUserData = null; 
                    }
                    
                    if (!currentUserData || currentUserData.id !== 'demo-user-ngan') {
                        const userDocRef = doc(db, `/artifacts/${appId}/users`, user.uid);
                        const userDocSnap = await getDoc(userDocRef);
                        
                        if (userDocSnap.exists()) {
                            currentUserData = { id: user.uid, ...userDocSnap.data() };
                        } else {
                            console.warn(`User doc for ${user.uid} not found immediately after auth change. This can happen on registration.`);
                        }
                    }
                } else { // User is null, anonymous, or logged out
                    currentUser = null;
                    currentUserData = null;
                }

                // Initialize the app once auth state is confirmed
                if (!isAppInitialized) {
                    initApp();
                    isAppInitialized = true;
                }

                // Update UI based on the new auth state
                updateUIForAuthState();
            });

            function updateUIForAuthState() {
                if (currentUserData) {
                    updateUIAfterLogin();
                    loadDynamicContentForUser();
                } else {
                    updateUIAfterLogout();
                    loadDynamicContentForGuest();
                }
            }
            
            function loadDynamicContentForUser() {
                document.getElementById('social-guest-view').classList.add('hidden');
                document.getElementById('social-user-view').classList.remove('hidden');
                document.getElementById('ai-question-limit').classList.add('hidden');
                renderSocialFeed(mockPosts.sort((a, b) => (b.likes || 0) - (a.likes || 0)));
                renderSocialSidebars();
                loadChatHistory();
            }

            function loadDynamicContentForGuest() {
                document.getElementById('social-user-view').classList.add('hidden');
                document.getElementById('social-guest-view').classList.remove('hidden');
                const aiLimitEl = document.getElementById('ai-question-limit');
                if (aiLimitEl) {
                    aiLimitEl.classList.remove('hidden');
                    document.getElementById('question-limit-count').textContent = guestQuestionCount;
                }
                loadChatHistory();
            }

            document.getElementById('login-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                const errorEl = document.getElementById('login-error');
                errorEl.classList.add('hidden');

                if (email === 'nganana23@gmail.com' && password === '12345678') {
                    currentUserData = { id: 'demo-user-ngan', name: 'Thi√™n Ng√¢n', username: 'nganana23', email: 'nganana23@gmail.com', avatar: 'https://placehold.co/40x40/fef08a/854d0e?text=N', friends: demoUserFriends, conversations: demoUserConversations, savedPosts: ['post8', 'post2'], likedPosts: ['post9', 'post8', 'post7']};
                    updateUIAfterLogin();
                    loadDynamicContentForUser();
                    closeModal(document.getElementById('login-modal'));
                    showToast("ƒêƒÉng nh·∫≠p th√†nh c√¥ng v·ªõi t√†i kho·∫£n Demo!");
                    return;
                }
                
                try {
                    await signInWithEmailAndPassword(auth, email, password);
                    closeModal(document.getElementById('login-modal'));
                    showToast("ƒêƒÉng nh·∫≠p th√†nh c√¥ng!");
                } catch (error) {
                    errorEl.textContent = "Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng.";
                    errorEl.classList.remove('hidden');
                }
            });

            document.getElementById('register-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('register-name').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const errorEl = document.getElementById('register-error');
                errorEl.classList.add('hidden');
                if (password.length < 6) {
                    errorEl.textContent = "M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±.";
                    errorEl.classList.remove('hidden');
                    return;
                }

                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    const user = userCredential.user;
                    const newUserDoc = { name: name, username: email.split('@')[0].replace(/[^a-zA-Z0-9]/g, ''), email: email, avatar: `https://placehold.co/56x56/FFE4E6/DC2626?text=${name.charAt(0).toUpperCase()}`, friends: [], savedPosts: [], likedPosts: [], createdAt: serverTimestamp() };
                    const userDocRef = doc(db, `/artifacts/${appId}/users`, user.uid);
                    await setDoc(userDocRef, newUserDoc);
                    // Manually set state to avoid race condition before onAuthStateChanged fires
                    currentUserData = { id: user.uid, ...newUserDoc };
                    updateUIAfterLogin();
                    loadDynamicContentForUser();
                    closeModal(document.getElementById('register-modal'));
                    showToast("ƒêƒÉng k√Ω th√†nh c√¥ng v√† ƒë√£ ƒëƒÉng nh·∫≠p!");
                } catch (error) {
                    errorEl.textContent = error.code === 'auth/email-already-in-use' ? "Email n√†y ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng." : "ƒê√£ x·∫£y ra l·ªói. Vui l√≤ng th·ª≠ l·∫°i.";
                    errorEl.classList.remove('hidden');
                }
            });

            async function handleLogout() {
                const isDemo = currentUserData && currentUserData.id === 'demo-user-ngan';
                if (isDemo) {
                    currentUserData = null; 
                }
                await signOut(auth); 
                showToast("ƒê√£ ƒëƒÉng xu·∫•t.");
            }

            function updateUIAfterLogin() { 
                const authContainer = document.getElementById('auth-container');
                const newPostBox = document.getElementById('new-post-box');
                if (!currentUserData) return;
                authContainer.innerHTML = `<div class="flex items-center gap-4"><span class="font-semibold text-gray-700 hidden sm:block">${currentUserData.name}</span><img src="${currentUserData.avatar}" alt="avatar" class="w-10 h-10 rounded-full cursor-pointer object-cover"><button id="logout-btn" title="ƒêƒÉng xu·∫•t" class="text-gray-500 hover:text-red-500 transition-colors"><i class="fas fa-sign-out-alt text-lg"></i></button></div>`;
                document.getElementById('logout-btn').addEventListener('click', handleLogout);
                newPostBox.classList.remove('hidden');
                newPostBox.innerHTML = `<div class="flex items-start"><img src="${currentUserData.avatar}" alt="User Avatar" class="w-10 h-10 rounded-full mr-3 object-cover"><textarea id="new-post-content" placeholder="B·∫°n ƒëang nghƒ© g√¨, ${currentUserData.name}?" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-pink-500 focus:border-pink-500 text-sm bg-gray-50" rows="3"></textarea></div><div class="flex justify-between items-center mt-3 pt-3 border-t"><button class="text-pink-600 hover:bg-pink-100 py-2 px-3 rounded-md text-sm"><i class="fas fa-image mr-1"></i> ·∫¢nh/Video</button><button id="submit-post-btn" class="bg-pink-500 hover:bg-pink-600 text-white font-semibold py-2 px-5 rounded-md text-sm">ƒêƒÉng</button></div>`;
                document.getElementById('submit-post-btn').addEventListener('click', handleCreatePost);
            }

            function updateUIAfterLogout() { 
                document.getElementById('auth-container').innerHTML = `<button id="open-login-modal-btn" class="btn-login">ƒêƒÉng Nh·∫≠p</button>`;
                document.getElementById('open-login-modal-btn').addEventListener('click', (e) => { e.preventDefault(); openModal(document.getElementById('login-modal')); });
                document.getElementById('new-post-box').classList.add('hidden');
            }
            
            function renderMarketplace(products) { const grid = document.getElementById('product-grid'); if(!grid) return; grid.innerHTML = ''; products.forEach(p => grid.appendChild(createProductCard(p))); }
            function renderLibrary(documents) { const grid = document.getElementById('document-grid'); if(!grid) return; grid.innerHTML = ''; documents.forEach(d => grid.appendChild(createDocumentCard(d))); }
            function renderSocialFeed(posts) { const c = document.getElementById('social-feed-container'); if(!c) return; c.innerHTML = ''; posts.forEach(p => c.appendChild(createPostCard(p))); }
            
            function createProductCard(product) { 
                const card = document.createElement('div');
                card.className = 'product-card flex flex-col transition-all duration-300';
                card.dataset.category = product.category || 'khac';
                card.innerHTML = `<div class="relative overflow-hidden rounded-t-lg"><img src="${product.imageUrl}" alt="${product.name}" class="w-full h-52 object-cover transition-transform duration-300 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/400x300/FFEBD9/9A3412?text=·∫¢nh+SP';"></div><div class="p-5 flex flex-col flex-grow"><h3 class="text-lg font-bold mb-2 text-gray-800 leading-tight">${product.name}</h3><p class="text-xl font-extrabold mb-3 text-red-600">${parseInt(product.price).toLocaleString('vi-VN')} VNƒê</p><div class="text-xs text-gray-500 mb-3 space-y-1"><p><i class="fas fa-user-circle mr-1.5 text-gray-400"></i> ${product.seller || 'Ng∆∞·ªùi b√°n ·∫©n danh'}</p><p><i class="fas fa-tag mr-1.5 text-gray-400"></i> ${product.tags ? product.tags.join(', ') : 'Ch∆∞a g·∫Øn th·∫ª'}</p></div><p class="text-gray-600 text-sm mb-4 flex-grow line-clamp-3">${product.description}</p><button class="mt-auto w-full font-semibold py-2.5 px-4 rounded-lg text-sm bg-orange-500 text-white hover:bg-orange-600 transition-colors"><i class="fas fa-cart-plus mr-2"></i>Th√™m v√†o gi·ªè</button></div>`;
                return card;
            }

            function createDocumentCard(docData) { 
                const card = document.createElement('div');
                card.className = 'document-card flex flex-col p-6 text-center hover:shadow-sky-200/50 transition-all duration-300';
                card.dataset.category = docData.category || 'all';
                card.innerHTML = `<div class="w-24 h-32 mx-auto mb-4 flex items-center justify-center"><i class="fas fa-file-alt text-6xl text-sky-400"></i></div><h3 class="text-base font-bold mb-2 text-gray-800 flex-grow">${docData.title}</h3><p class="text-xs text-gray-500 mb-3"><span class="bg-sky-100 text-sky-700 py-0.5 px-2 rounded-full font-medium">${docData.type}</span></p><a href="${docData.url}" target="_blank" class="w-full block font-semibold py-2 px-4 rounded-lg text-sm bg-sky-500 text-white hover:bg-sky-600 transition-colors"><i class="fas fa-download mr-2"></i>T·∫£i V·ªÅ</a>`;
                return card;
             }
            function createPostCard(post) { 
                const article = document.createElement('article');
                article.className = 'insta-post-card';
                article.dataset.postId = post.id;
                const isLiked = currentUserData?.likedPosts?.includes(post.id);
                const isSaved = currentUserData?.savedPosts?.includes(post.id);
                article.innerHTML = `<header class="insta-post-header"><img src="${post.authorAvatar}" alt="${post.authorName} Avatar" class="avatar object-cover"><div><a href="#" class="username">${post.authorUsername}</a><div class="location">${post.location || 'HUB, TP.HCM'}</div></div><button class="options-btn"><i class="fas fa-ellipsis-h"></i></button></header>${post.imageUrl ? `<img src="${post.imageUrl}" alt="Post image" class="insta-post-image" onerror="this.style.display='none'">` : ''}<div class="px-4 pt-3 pb-1"><p class="text-gray-800">${post.caption}</p></div><section class="insta-post-actions"><button class="like-btn ${isLiked ? 'liked' : ''}" title="Th√≠ch"><i class="fa-${isLiked ? 'solid' : 'regular'} fa-heart"></i></button><button class="comment-btn" title="B√¨nh lu·∫≠n"><i class="far fa-comment"></i></button><button class="share-btn" title="Chia s·∫ª"><i class="far fa-paper-plane"></i></button><button class="save-btn ${isSaved ? 'saved' : ''}"><i class="fa-${isSaved ? 'solid' : 'regular'} fa-bookmark"></i></button></section><section class="px-4 pb-2 insta-post-likes"><span class="like-count font-semibold">${post.likes || 0}</span> l∆∞·ª£t th√≠ch</section>`;
                article.querySelector('.like-btn').addEventListener('click', (e) => { e.preventDefault(); handleLike(post.id, e.currentTarget); });
                article.querySelector('.save-btn').addEventListener('click', (e) => { e.preventDefault(); handleSave(post.id, e.currentTarget); });
                return article;
            }
            async function handleCreatePost() { /* ... */ }
            async function handleLike(postId, button) { /* ... */ }
            async function handleSave(postId, button) { /* ... */ }

            function renderSocialSidebars() {
                renderProfileSidebar();
                renderFriendsSidebar();
            }

            function renderProfileSidebar() {
                const container = document.getElementById('social-profile-sidebar');
                if (!container) return;
                let profileHtml = '';
                if(currentUserData) {
                    profileHtml = `<div class="bg-white p-5 rounded-lg shadow border"><div class="flex items-center mb-4"><img src="${currentUserData.avatar}" alt="Your Avatar" class="w-14 h-14 rounded-full mr-4 object-cover"><div><p class="font-semibold text-gray-800">${currentUserData.name}</p><p class="text-sm text-gray-500">@${currentUserData.username}</p></div></div></div>`;
                } else {
                    profileHtml = `<div class="bg-white p-5 rounded-lg shadow border text-center"><p class="text-sm text-gray-600">Ch√†o m·ª´ng ƒë·∫øn HUBverse!</p></div>`;
                }
                container.innerHTML = profileHtml + `<div class="bg-white p-5 rounded-lg shadow border"><h4 class="text-sm font-semibold text-gray-500 mb-3">G·ª£i √Ω cho b·∫°n</h4><div class="space-y-3"><p class="text-xs text-gray-400">T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn.</p></div></div>`;
            }

            function renderFriendsSidebar() {
                const container = document.getElementById('social-friends-sidebar');
                if(!container) return;
                if (!currentUserData) {
                    container.innerHTML = "";
                    return;
                }
                
                const friends = currentUserData.friends || [];
                const conversations = currentUserData.conversations || [];
                
                let friendsHtml = friends.map(friend => `
                    <div class="friend-item flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 cursor-pointer" onclick="openChatBox(this)" data-friend-id="${friend.id}" data-friend-name="${friend.name}" data-friend-avatar="${friend.avatar}">
                        <div class="relative"><img src="${friend.avatar}" alt="${friend.name}" class="w-10 h-10 rounded-full object-cover"><span class="online-status ${friend.online ? 'online' : ''} absolute bottom-0 right-0"></span></div>
                        <span class="font-medium text-sm text-gray-700">${friend.name}</span>
                    </div>`).join('');

                let convosHtml = conversations.map(convo => `
                    <div class="friend-item flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 cursor-pointer" onclick="openChatBox(this)" data-friend-id="${convo.friendId}" data-friend-name="${convo.name}" data-friend-avatar="${convo.avatar}">
                        <img src="${convo.avatar}" alt="${convo.name}" class="w-10 h-10 rounded-full object-cover">
                        <div class="flex-grow overflow-hidden"><p class="font-semibold text-sm truncate">${convo.name}</p><p class="text-xs text-gray-500 truncate">${convo.unread ? `<strong>${convo.lastMessage}</strong>` : convo.lastMessage}</p></div>
                        ${convo.unread ? `<div class="w-3 h-3 bg-pink-500 rounded-full flex-shrink-0"></div>` : ''}
                    </div>`).join('');

                container.innerHTML = `
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex border-b mb-2"><button data-pane="messages" class="sidebar-tab active-sidebar-tab">Tin nh·∫Øn</button><button data-pane="online-friends" class="sidebar-tab">ƒêang ho·∫°t ƒë·ªông</button></div>
                        <div id="messages" class="sidebar-tab-pane active-sidebar-pane space-y-2">${convosHtml || '<p class="text-xs text-center text-gray-500 p-4">Kh√¥ng c√≥ tin nh·∫Øn n√†o.</p>'}</div>
                        <div id="online-friends" class="sidebar-tab-pane space-y-2">${friendsHtml || '<p class="text-xs text-center text-gray-500 p-4">Kh√¥ng c√≥ b·∫°n b√® n√†o.</p>'}</div>
                    </div>`;
                
                container.querySelectorAll('.sidebar-tab').forEach(tab => tab.addEventListener('click', (e) => {
                    const targetPaneId = e.currentTarget.dataset.pane;
                    container.querySelector('.active-sidebar-tab').classList.remove('active-sidebar-tab');
                    e.currentTarget.classList.add('active-sidebar-tab');
                    container.querySelectorAll('.sidebar-tab-pane').forEach(pane => pane.classList.toggle('active-sidebar-pane', pane.id === targetPaneId));
                }));
            }
            
            // --- AI CHATBOT LOGIC ---
            const geminiChatInput = document.getElementById('gemini-chat-input');
            const geminiSendButton = document.getElementById('gemini-send-button');
            let chatHistory = [];
            const systemInstruction = {
                role: "system",
                parts: [{ text: "You are a friendly and helpful study assistant for students at HUB (Ho Chi Minh City University of Banking). Be encouraging, provide clear explanations for academic questions, and keep a positive tone. Your name is HUB AI." }]
            };

            async function loadChatHistory() {
                 const initialMessage = "Xin ch√†o! M√¨nh l√† HUB AI, ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh h·ªçc t·∫≠p c·ªßa b·∫°n. B·∫°n c·∫ßn h·ªó tr·ª£ g√¨ h√¥m nay?";
                 const welcomeMessage = { role: "model", parts: [{text: initialMessage}] };
                 
                 chatHistory = [welcomeMessage]; // Reset history for display
                 
                 if (currentUserData) {
                    const chatRef = doc(db, `/artifacts/${appId}/users/${currentUserData.id}/private/chatHistory`);
                    const docSnap = await getDoc(chatRef);
                    if (docSnap.exists() && docSnap.data().messages) {
                        chatHistory = docSnap.data().messages;
                    } else {
                        await setDoc(chatRef, { messages: chatHistory });
                    }
                 }

                 const geminiChatMessages = document.getElementById('gemini-chat-messages');
                 if(geminiChatMessages) {
                    geminiChatMessages.innerHTML = '';
                    chatHistory.forEach(msg => addGeminiMessage(msg.parts[0].text, msg.role));
                 }
            }
            function addGeminiMessage(message, sender, isLoading = false) {
                const geminiChatMessages = document.getElementById('gemini-chat-messages');
                if (!geminiChatMessages) return;
                const bubbleDiv = document.createElement('div');
                const senderClass = sender === 'model' ? 'ai' : 'user';
                bubbleDiv.classList.add('gemini-chat-bubble', senderClass);

                const avatarDiv = document.createElement('div');
                avatarDiv.classList.add('avatar');
                if (senderClass === 'user') {
                    avatarDiv.classList.add('avatar-user');
                    avatarDiv.textContent = currentUserData ? currentUserData.name.charAt(0).toUpperCase() : 'B';
                } else {
                    avatarDiv.classList.add('avatar-ai');
                    avatarDiv.innerHTML = `<i class="fas fa-brain"></i>`;
                }

                const messageContentDiv = document.createElement('div');
                messageContentDiv.classList.add('message-content');
                messageContentDiv.innerHTML = isLoading ? `<p class="animate-pulse">ƒêang suy nghƒ©...</p>` : `<p>${message.replace(/\n/g, '<br>')}</p>`;
                if (isLoading) bubbleDiv.id = 'loading-bubble';
                
                bubbleDiv.append(avatarDiv, messageContentDiv);
                geminiChatMessages.appendChild(bubbleDiv);
                geminiChatMessages.scrollTop = geminiChatMessages.scrollHeight;
            }
            async function handleSendMessage() {
                const isGuest = !currentUserData;
                if (isGuest && guestQuestionCount <= 0) {
                    showToast("B·∫°n ƒë√£ h·∫øt l∆∞·ª£t h·ªèi mi·ªÖn ph√≠. Vui l√≤ng ƒëƒÉng nh·∫≠p.");
                    openModal(document.getElementById('login-modal'));
                    return;
                }
                const userMessage = geminiChatInput.value.trim();
                if (!userMessage) return;

                addGeminiMessage(userMessage, 'user');
                geminiChatInput.value = '';
                addGeminiMessage('', 'model', true); // Show loading indicator

                if(isGuest) {
                    guestQuestionCount--;
                    document.getElementById('question-limit-count').textContent = guestQuestionCount;
                }

                // Add system instruction to the beginning of the payload
                const currentConversation = [systemInstruction, ...chatHistory, { role: "user", parts: [{ text: userMessage }] }];
                const payload = { contents: currentConversation };
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    const result = await response.json();
                    
                    document.getElementById('loading-bubble')?.remove();

                    if (result.candidates && result.candidates[0]?.content?.parts[0]) {
                        const aiResponse = result.candidates[0].content.parts[0].text;
                        addGeminiMessage(aiResponse, 'model');
                        chatHistory.push({ role: "user", parts: [{ text: userMessage }] });
                        chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
                        if (!isGuest) {
                            const chatRef = doc(db, `/artifacts/${appId}/users/${currentUserData.id}/private/chatHistory`);
                            await setDoc(chatRef, { messages: chatHistory });
                        }
                    } else { 
                        console.error("Gemini API Error Response:", result);
                        addGeminiMessage("Xin l·ªói, t√¥i kh√¥ng th·ªÉ t·∫°o ph·∫£n h·ªìi l√∫c n√†y.", 'model'); 
                    }
                } catch (error) {
                    console.error("Gemini API Fetch Error:", error);
                    document.getElementById('loading-bubble')?.remove();
                    addGeminiMessage("ƒê√£ c√≥ l·ªói m·∫°ng. Vui l√≤ng th·ª≠ l·∫°i.", 'model');
                }
            }

            window.openChatBox = (el) => {
                const { friendId, friendName, friendAvatar } = el.dataset;
                const chatContainer = document.getElementById('chat-boxes-container');
                if (document.getElementById(`chat-box-${friendId}`)) return; 
                const chatBox = document.createElement('div');
                chatBox.id = `chat-box-${friendId}`;
                chatBox.className = 'chat-box';
                chatBox.innerHTML = `
                    <div class="chat-box-header" onclick="this.parentElement.classList.toggle('minimized')">
                        <img src="${friendAvatar}" class="w-8 h-8 rounded-full mr-3 object-cover"/>
                        <span class="font-semibold flex-grow">${friendName}</span>
                        <button class="mr-2 hover:bg-white/20 p-1 rounded-full"><i class="fas fa-minus text-xs"></i></button>
                        <button class="hover:bg-white/20 p-1 rounded-full" onclick="event.stopPropagation(); this.closest('.chat-box').remove()"><i class="fas fa-times text-xs"></i></button>
                    </div>
                    <div class="chat-box-body"><div class="chat-box-bubble received">Ch√†o b·∫°n, c√≥ g√¨ kh√¥ng?</div></div>
                    <div class="chat-box-footer"><input type="text" placeholder="Nh·∫Øn tin..." class="chat-box-input"/><button class="text-pink-500"><i class="fas fa-paper-plane"></i></button></div>`;
                chatContainer.appendChild(chatBox);
            };

            // --- PAGE ROUTING & INITIALIZATION ---
            function initApp() {
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                const pageRouterLinks = document.querySelectorAll('.page-router-link');
                const pageSections = document.querySelectorAll('.page-content-section');
                const navLinks = document.querySelectorAll('header nav .nav-link');

                function showPage(targetPageId) {
                    pageSections.forEach(s => s.classList.remove('active-page'));
                    navLinks.forEach(l => l.classList.remove('active-nav-link'));

                    if (targetPageId === 'home') {
                        document.getElementById('hero-section').classList.add('active-page');
                        document.getElementById('features-overview').classList.add('active-page');
                        document.getElementById('team-section').classList.add('active-page');
                    } else {
                        const targetSection = document.getElementById(targetPageId);
                        if (targetSection) {
                            targetSection.classList.add('active-page');
                        } else {
                            document.getElementById('hero-section').classList.add('active-page');
                            document.getElementById('features-overview').classList.add('active-page');
                            document.getElementById('team-section').classList.add('active-page');
                            targetPageId = 'home';
                        }
                    }
                    const activeNavLink = document.querySelector(`header nav .nav-link[data-target-page="${targetPageId}"]`);
                    if (activeNavLink) activeNavLink.classList.add('active-nav-link');
                    window.scrollTo(0, 0);
                }

                pageRouterLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); showPage(e.currentTarget.dataset.targetPage); }); });
                
                function openModal(modal) { if (modal) modal.classList.add('active'); }
                function closeModal(modal) { if (modal) modal.classList.remove('active'); }
                document.body.addEventListener('click', e => { if(e.target.id === 'open-login-modal-btn') { e.preventDefault(); openModal(document.getElementById('login-modal')); } });
                document.getElementById('open-register-modal-cta').addEventListener('click', (e) => { e.preventDefault(); openModal(document.getElementById('register-modal')); });
                document.getElementById('login-from-social-prompt')?.addEventListener('click', (e) => { e.preventDefault(); openModal(document.getElementById('login-modal')); });

                [document.getElementById('login-modal'), document.getElementById('register-modal'), document.getElementById('team-letter-modal')].forEach(modal => { 
                    if (modal) modal.addEventListener('click', e => { if (e.target === modal || e.target.classList.contains('modal-close-btn')) closeModal(modal); }); 
                });
                document.getElementById('show-register-from-login').addEventListener('click', (e) => { e.preventDefault(); closeModal(document.getElementById('login-modal')); openModal(document.getElementById('register-modal')); });
                document.getElementById('show-login-from-register').addEventListener('click', (e) => { e.preventDefault(); closeModal(document.getElementById('register-modal')); openModal(document.getElementById('login-modal')); });
                document.getElementById('explore-now-btn').addEventListener('click', function(e) { e.preventDefault(); document.getElementById('features-overview').scrollIntoView({ behavior: 'smooth' }); });
                
                const newsTabsMenu = document.querySelector('.news-events-tabs-menu');
                if(newsTabsMenu) {
                    newsTabsMenu.addEventListener('click', (e) => {
                        if (e.target.tagName === 'BUTTON') {
                            newsTabsMenu.querySelector('.active-news-tab').classList.remove('active-news-tab');
                            e.target.classList.add('active-news-tab');
                            const targetId = e.target.dataset.target;
                            document.querySelectorAll('.news-event-content-pane').forEach(pane => pane.classList.toggle('active', pane.id === targetId));
                        }
                    });
                }

                function setupFilter(tabContainerId, gridId, data) {
                    const filterTabs = document.getElementById(tabContainerId);
                    if(!filterTabs) return;
                    filterTabs.addEventListener('click', (e) => {
                        if (e.target.classList.contains('filter-tab-item')) {
                            filterTabs.querySelector('.active-tab').classList.remove('active-tab');
                            e.target.classList.add('active-tab');
                            const filter = e.target.dataset.filter;
                            const filteredData = (filter === 'all') ? data : data.filter(item => item.category === filter);
                            if(gridId === 'product-grid') renderMarketplace(filteredData);
                            if(gridId === 'document-grid') renderLibrary(filteredData);
                        }
                    });
                }
                setupFilter('marketplace-filter-tabs', 'product-grid', mockProducts);
                setupFilter('library-filter-tabs', 'document-grid', mockDocuments);
                renderMarketplace(mockProducts);
                renderLibrary(mockDocuments);
                
                const teamLetterModal = document.getElementById('team-letter-modal');
                document.querySelectorAll('.team-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const { name, role, avatar, message, color } = card.dataset;
                        document.getElementById('letter-name').textContent = name;
                        const roleEl = document.getElementById('letter-role');
                        roleEl.textContent = role;
                        roleEl.style.color = color;
                        document.getElementById('letter-avatar').src = avatar;
                        document.getElementById('letter-body').innerHTML = `<p>${message.replace(/\n/g, '<br>')}</p>`;
                        openModal(teamLetterModal);
                    });
                });

                if (geminiSendButton) geminiSendButton.addEventListener('click', handleSendMessage);
                if (geminiChatInput) geminiChatInput.addEventListener('keypress', (e) => { if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleSendMessage(); } });
                document.getElementById('login-for-more').addEventListener('click', (e) => { e.preventDefault(); openModal(document.getElementById('login-modal')); });

                const heroSection = document.querySelector('.hero-section');
                const heroCanvas = document.getElementById('hero-3d-canvas');
                const teamSection = document.getElementById('team-section');
                const teamCanvas = document.getElementById('team-3d-canvas');
                
                function createStarField(container, canvas) {
                    if (!container || !canvas || typeof THREE === 'undefined') return;
                    const scene = new THREE.Scene();
                    const camera = new THREE.PerspectiveCamera(60, container.offsetWidth / container.offsetHeight, 1, 1000);
                    camera.position.z = 1;
                    const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
                    renderer.setSize(container.offsetWidth, container.offsetHeight);
                    
                    const starGeo = new THREE.BufferGeometry();
                    const starCount = 6000;
                    const positions = new Float32Array(starCount * 3);
                    for(let i=0; i<starCount; i++) { positions[i*3+0] = (Math.random() - 0.5) * 1000; positions[i*3+1] = (Math.random() - 0.5) * 1000; positions[i*3+2] = (Math.random() - 0.5) * 1000; }
                    starGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                    const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.7, transparent: true });
                    const stars = new THREE.Points(starGeo, starMaterial);
                    scene.add(stars);
                    
                    let mouseX = 0, mouseY = 0;
                    container.addEventListener('mousemove', (e) => { mouseX = e.clientX - window.innerWidth / 2; mouseY = e.clientY - window.innerHeight / 2; });
                    
                    function animate() {
                        requestAnimationFrame(animate);
                        stars.rotation.y = -mouseX * 0.00005;
                        stars.rotation.x = -mouseY * 0.00005;
                        stars.rotation.z += 0.0001;
                        renderer.render(scene, camera);
                    }
                    animate();

                    window.addEventListener('resize', () => {
                        camera.aspect = container.offsetWidth / container.offsetHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(container.offsetWidth, container.offsetHeight);
                    });
                }

                createStarField(heroSection, heroCanvas);
                createStarField(teamSection, teamCanvas);
                
                showPage('home');
            }
        });
    </script>
</body>
</html>
